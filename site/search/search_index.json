{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Bienvenido a MKdoc Restituto S\u00e1nchez S\u00e1nchez Estructura actual: docs - Practica1.md - about.md - docker-https.md - index.md site - todo el contenido html y xml mkdocs.yml","title":"Principal"},{"location":"#bienvenido-a-mkdoc","text":"","title":"Bienvenido a MKdoc"},{"location":"#restituto-sanchez-sanchez","text":"","title":"Restituto S\u00e1nchez S\u00e1nchez"},{"location":"#estructura-actual","text":"docs - Practica1.md - about.md - docker-https.md - index.md site - todo el contenido html y xml mkdocs.yml","title":"Estructura actual:"},{"location":"Practica1/","text":"ASIR2-IAW-Practica01 Practica 01 - IAW Pila L.A.M.P. L.A.M.P. Es el acr\u00f3nimo utilizado para describir un sistema de infraestructura de Internet que usa las siguientes herramientas: - Linux - Apache - MySQL/MariaDB - PHP Linux Los siguientes comandos b\u00e1sicos son los utilizados en la pr\u00e1ctica , es recomendable e incluso obligatorio utilzar sudo: apt update Actualiza la lista de paquetes sudo apt update apt upgrade Actualiza los paquetes instalados a sus ultimas versiones disponibles sudo apt upgrade apt install Instala un paquete determinado sudo apt install apt remove Desinstala un paquete sudo apt remove (OPCIONAL) Instalaci\u00f3n de interfaz gr\u00e1fica Unity -> sudo apt install ubuntu-desktop GNOME -> sudo apt install ubuntu-gnome-desktop KDE -> sudo apt install kubuntu-desktop Instalaci\u00f3n del servidor SSH sudo apt install ssh Como iniciar , parar y consultar el servicio SSH sudo systemctl start/stop/status ssh Apache Instalaci\u00f3n Apache sudo apt install apache2 Como iniciar , parar, reiniciar , recargar y consultar el servicio Apache sudo systemctl start/stop/restart/reload/status apache2 Archivos de configuraci\u00f3n de Apache /* Archivos */ \u251c\u2500\u2500 apache2.conf \u251c\u2500\u2500 envvars \u251c\u2500\u2500 magic \u2514\u2500\u2500 ports.conf /* Directorios */ \u251c\u2500\u2500 conf-available \u251c\u2500\u2500 conf-enabled \u251c\u2500\u2500 mods-available \u251c\u2500\u2500 mods-enabled \u251c\u2500\u2500 sites-available \u2514\u2500\u2500 sites-enabled Archivos de log de Apache access.log El servidor almacena en el registro de accceso informaci\u00f3n sobre todas las peticiones que procesa error.log El registro de errores del servidor Mensajes de error m\u00e1s detallados Necesitamos cambiar o a\u00f1adir la linea LogLevel en el archivo de /etc/apache2/apache2.conf , los argumentos posibles son: emerg: Emergencias, no se puede utilizar el servidor. alert: Require acci\u00f3n inmediata. crit: Condiciones cr\u00edticas. error: Condiciones de error. warn: Condiciones de advertencia. (Por defecto) notice: Condic\u00f3n normal pero significativa. info: Informativa. debug: Mensajes de correcci\u00f3n de errores. MySQL Server Instalaci\u00f3n de MySQL Server sudo apt install mysql-server Como iniciar, parar y consultar el estado de MySQL sudo systemctl start/stop/restart/status mysql Archivos de configuraci\u00f3n de MySQL Server El principal /etc/mysql/mysql.cnf Existen otros archivos de configuraci\u00f3n: /etc/mysql/conf.d /etc/mysql/mysql.conf.d/ Archivos de log de MySQL Server /var/log/mysql/error.log Como acceder a MySQL Server desde consola con root sudo su mysql -u root Como cambiar la contrase\u00f1a del usuario root Accedemos a la consola de MySQL como root y seleccionamos la base de datos mysql para ver los usuarios y el tipo de autenticaci\u00f3n que tienen. Para cambiar la contrase\u00f1a de root cambiamos el m\u00e9todo de autenticaci\u00f3n ALTER USER 'root'@'localhost' IDENTIFIED WITH caching_sha2_password BY 'nueva_contrase\u00f1a'; A continuaci\u00f3n ejecutamos el siguiente comando para actualizar la contrase\u00f1a FLUSH PRIVILEGES; Ejecutar un script.sql desde consola Desde consola linux: mysql -u -p < script.sql Desde la consola de MySQL: mysql> source script.sql Usuarios y permisos en MySQL Server desde consola Tipos de permisos que podemos aplicar ```ALL PRIVILEGES: permite a un usuario de MySQL acceder a todas las bases de datos asignadas en el sistema. CREATE: permite crear nuevas tablas o bases de datos. DROP: permite eliminar tablas o bases de datos DELETE: permite eliminar registros de tablas. INSERT: permite insertar registros en tablas. SELECT: permite leer registros en las tablas. UPDATE: permite actualizar registros seleccionados en tablas. GRANT OPTION: permite asignar privilegios a otros usuarios. #### Crear un nuevo usuario ``` CREATE USER 'nombre_usuario'@'localhost' IDENTIFIED BY 'contrase\u00f1a'; ``` #### Eliminar un usuario DROP USER 'nombre_usuario'@'localhost'; #### Asignar permisos a un usuario ``` GRANT [permiso] ON [nombre_base_de_datos].[nombre_tabla] TO 'nombre_usuario'@'localhost'; ``` Despu\u00e9s de este comando habr\u00e1 que ejecutar el siguiente comando para refrescar todos los privilegios ``` FLUSH PRIVILEGES; ``` #### Eliminar permisos a un usuario REVOKE [permiso] ON [nombre_base_de_datos].[nombre_tabla] FROM 'nombre_usuario'@'localhost'; ## PHP - ### Instalaci\u00f3n de m\u00f3dulos PHP sudo apt install php libapache2-mod-php php-msyql ## Otras herramientas relacionadas con la pila LAMP - ### Instalar phpMyAdmin para acceder v\u00eda web a MySQL #### Instalaci\u00f3n de phpMyAdmin con apt sudo apt install phpmyadmin php-mbstring php-zip php-gd php-json php-curl - ### Instalaci\u00f3n de GoAccess Para instalar la ultima versi\u00f3n de GoAccess a\u00f1adimos los repositorios oficiales del proyecto echo \"deb http://deb.goaccess.io/ $(lsb_release -cs) main\" | sudo tee -a /etc/apt/sources.list.d/goaccess.list wget -O - https://deb.goaccess.io/gnugpg.key | sudo apt-key add - sudo apt-get update sudo apt-get install goaccess ```","title":"Practica1"},{"location":"Practica1/#asir2-iaw-practica01","text":"","title":"ASIR2-IAW-Practica01"},{"location":"Practica1/#practica-01-iaw-pila-lamp","text":"L.A.M.P. Es el acr\u00f3nimo utilizado para describir un sistema de infraestructura de Internet que usa las siguientes herramientas: - Linux - Apache - MySQL/MariaDB - PHP","title":"Practica 01 - IAW Pila L.A.M.P."},{"location":"Practica1/#linux","text":"Los siguientes comandos b\u00e1sicos son los utilizados en la pr\u00e1ctica , es recomendable e incluso obligatorio utilzar sudo:","title":"Linux"},{"location":"Practica1/#apt-update","text":"Actualiza la lista de paquetes sudo apt update","title":"apt update"},{"location":"Practica1/#apt-upgrade","text":"Actualiza los paquetes instalados a sus ultimas versiones disponibles sudo apt upgrade","title":"apt upgrade"},{"location":"Practica1/#apt-install","text":"Instala un paquete determinado sudo apt install","title":"apt install"},{"location":"Practica1/#apt-remove","text":"Desinstala un paquete sudo apt remove","title":"apt remove"},{"location":"Practica1/#opcional-instalacion-de-interfaz-grafica","text":"Unity -> sudo apt install ubuntu-desktop GNOME -> sudo apt install ubuntu-gnome-desktop KDE -> sudo apt install kubuntu-desktop","title":"(OPCIONAL) Instalaci\u00f3n de interfaz gr\u00e1fica"},{"location":"Practica1/#instalacion-del-servidor-ssh","text":"sudo apt install ssh","title":"Instalaci\u00f3n del servidor SSH"},{"location":"Practica1/#como-iniciar-parar-y-consultar-el-servicio-ssh","text":"sudo systemctl start/stop/status ssh","title":"Como iniciar , parar y consultar el servicio SSH"},{"location":"Practica1/#apache","text":"","title":"Apache"},{"location":"Practica1/#instalacion-apache","text":"sudo apt install apache2","title":"Instalaci\u00f3n Apache"},{"location":"Practica1/#como-iniciar-parar-reiniciar-recargar-y-consultar-el-servicio-apache","text":"sudo systemctl start/stop/restart/reload/status apache2","title":"Como iniciar , parar, reiniciar , recargar y consultar el servicio Apache"},{"location":"Practica1/#archivos-de-configuracion-de-apache","text":"/* Archivos */ \u251c\u2500\u2500 apache2.conf \u251c\u2500\u2500 envvars \u251c\u2500\u2500 magic \u2514\u2500\u2500 ports.conf /* Directorios */ \u251c\u2500\u2500 conf-available \u251c\u2500\u2500 conf-enabled \u251c\u2500\u2500 mods-available \u251c\u2500\u2500 mods-enabled \u251c\u2500\u2500 sites-available \u2514\u2500\u2500 sites-enabled","title":"Archivos de configuraci\u00f3n de Apache"},{"location":"Practica1/#archivos-de-log-de-apache","text":"","title":"Archivos de log de Apache"},{"location":"Practica1/#accesslog","text":"El servidor almacena en el registro de accceso informaci\u00f3n sobre todas las peticiones que procesa","title":"access.log"},{"location":"Practica1/#errorlog","text":"El registro de errores del servidor","title":"error.log"},{"location":"Practica1/#mensajes-de-error-mas-detallados","text":"Necesitamos cambiar o a\u00f1adir la linea LogLevel en el archivo de /etc/apache2/apache2.conf , los argumentos posibles son: emerg: Emergencias, no se puede utilizar el servidor. alert: Require acci\u00f3n inmediata. crit: Condiciones cr\u00edticas. error: Condiciones de error. warn: Condiciones de advertencia. (Por defecto) notice: Condic\u00f3n normal pero significativa. info: Informativa. debug: Mensajes de correcci\u00f3n de errores.","title":"Mensajes de error m\u00e1s detallados"},{"location":"Practica1/#mysql-server","text":"","title":"MySQL Server"},{"location":"Practica1/#instalacion-de-mysql-server","text":"sudo apt install mysql-server","title":"Instalaci\u00f3n de MySQL Server"},{"location":"Practica1/#como-iniciar-parar-y-consultar-el-estado-de-mysql","text":"sudo systemctl start/stop/restart/status mysql","title":"Como iniciar, parar y consultar el estado de MySQL"},{"location":"Practica1/#archivos-de-configuracion-de-mysql-server","text":"El principal /etc/mysql/mysql.cnf Existen otros archivos de configuraci\u00f3n: /etc/mysql/conf.d /etc/mysql/mysql.conf.d/","title":"Archivos de configuraci\u00f3n de MySQL Server"},{"location":"Practica1/#archivos-de-log-de-mysql-server","text":"/var/log/mysql/error.log","title":"Archivos de log de MySQL Server"},{"location":"Practica1/#como-acceder-a-mysql-server-desde-consola-con-root","text":"sudo su mysql -u root","title":"Como acceder a MySQL Server desde consola con root"},{"location":"Practica1/#como-cambiar-la-contrasena-del-usuario-root","text":"Accedemos a la consola de MySQL como root y seleccionamos la base de datos mysql para ver los usuarios y el tipo de autenticaci\u00f3n que tienen. Para cambiar la contrase\u00f1a de root cambiamos el m\u00e9todo de autenticaci\u00f3n ALTER USER 'root'@'localhost' IDENTIFIED WITH caching_sha2_password BY 'nueva_contrase\u00f1a'; A continuaci\u00f3n ejecutamos el siguiente comando para actualizar la contrase\u00f1a FLUSH PRIVILEGES;","title":"Como cambiar la contrase\u00f1a del usuario root"},{"location":"Practica1/#ejecutar-un-scriptsql-desde-consola","text":"Desde consola linux: mysql -u -p < script.sql Desde la consola de MySQL: mysql> source script.sql","title":"Ejecutar un script.sql desde consola"},{"location":"Practica1/#usuarios-y-permisos-en-mysql-server-desde-consola","text":"","title":"Usuarios y permisos en MySQL Server desde consola"},{"location":"Practica1/#tipos-de-permisos-que-podemos-aplicar","text":"```ALL PRIVILEGES: permite a un usuario de MySQL acceder a todas las bases de datos asignadas en el sistema. CREATE: permite crear nuevas tablas o bases de datos. DROP: permite eliminar tablas o bases de datos DELETE: permite eliminar registros de tablas. INSERT: permite insertar registros en tablas. SELECT: permite leer registros en las tablas. UPDATE: permite actualizar registros seleccionados en tablas. GRANT OPTION: permite asignar privilegios a otros usuarios. #### Crear un nuevo usuario ``` CREATE USER 'nombre_usuario'@'localhost' IDENTIFIED BY 'contrase\u00f1a'; ``` #### Eliminar un usuario DROP USER 'nombre_usuario'@'localhost'; #### Asignar permisos a un usuario ``` GRANT [permiso] ON [nombre_base_de_datos].[nombre_tabla] TO 'nombre_usuario'@'localhost'; ``` Despu\u00e9s de este comando habr\u00e1 que ejecutar el siguiente comando para refrescar todos los privilegios ``` FLUSH PRIVILEGES; ``` #### Eliminar permisos a un usuario REVOKE [permiso] ON [nombre_base_de_datos].[nombre_tabla] FROM 'nombre_usuario'@'localhost'; ## PHP - ### Instalaci\u00f3n de m\u00f3dulos PHP sudo apt install php libapache2-mod-php php-msyql ## Otras herramientas relacionadas con la pila LAMP - ### Instalar phpMyAdmin para acceder v\u00eda web a MySQL #### Instalaci\u00f3n de phpMyAdmin con apt sudo apt install phpmyadmin php-mbstring php-zip php-gd php-json php-curl - ### Instalaci\u00f3n de GoAccess Para instalar la ultima versi\u00f3n de GoAccess a\u00f1adimos los repositorios oficiales del proyecto echo \"deb http://deb.goaccess.io/ $(lsb_release -cs) main\" | sudo tee -a /etc/apt/sources.list.d/goaccess.list wget -O - https://deb.goaccess.io/gnugpg.key | sudo apt-key add - sudo apt-get update sudo apt-get install goaccess ```","title":"Tipos de permisos que podemos aplicar"},{"location":"about/","text":"Sobre mi Prueba Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris luctus tempus mi, nec sollicitudin quam fermentum at. Quisque sit amet sapien ac dolor pellentesque porta in a velit. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Mauris in purus non risus blandit sagittis. Interdum et malesuada fames ac ante ipsum primis in faucibus. Donec blandit, dolor eu vulputate viverra, ex eros lobortis enim, nec ullamcorper leo purus rhoncus sem. Praesent varius dui quis augue semper, sit amet interdum velit ultricies. Suspendisse vel accumsan orci. Aliquam sit amet aliquet neque. Etiam sed nibh ipsum. Aliquam id sapien ut dolor lacinia fermentum. Etiam luctus interdum tortor, ut bibendum sem pretium quis. Nulla aliquet consequat tristique. Nulla ut malesuada ipsum. Pellentesque id commodo augue, ut pharetra ante. Cras ante orci, lacinia vitae rhoncus tincidunt, porttitor non magna. Vivamus eu tempor velit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi aliquet ex sit amet felis laoreet, sed tincidunt lacus placerat. Phasellus et odio massa. Quisque pulvinar convallis molestie. Vivamus feugiat ut augue quis congue. Maecenas rutrum lorem a lorem aliquet, eget condimentum dui efficitur. Aliquam erat volutpat. Cras rhoncus eleifend nibh ac tincidunt. Integer vestibulum suscipit lectus, vel venenatis ipsum. Nullam a porttitor ante. Mauris et quam eu magna consectetur maximus. Morbi aliquet convallis dignissim. Etiam eleifend venenatis nunc et tristique. Pellentesque dolor mauris, euismod non vehicula vel, elementum quis dolor. Donec condimentum porttitor arcu, ut fringilla dui consequat egestas. Nulla ultricies efficitur sapien ut finibus. Integer eu mauris augue. Nunc congue molestie arcu eu ultrices. Pellentesque nulla risus, finibus eu cursus at, molestie a sem. Nullam accumsan scelerisque turpis nec semper. Nulla tincidunt convallis dignissim. Vestibulum metus ex, consequat ac rhoncus elementum, tempor a eros. In malesuada tincidunt nibh sed egestas. Aliquam sodales felis non mi suscipit bibendum. Phasellus et augue eget ipsum iaculis lacinia in et nunc. Nullam lorem justo, fringilla eu dictum nec, varius eget nibh. Praesent at suscipit est. Vestibulum et tellus condimentum, cursus ligula quis, semper felis. Pellentesque eu odio eget massa cursus placerat ornare et leo. Aenean non arcu ultrices, semper enim feugiat, commodo neque. Integer nec nisi placerat, tincidunt ligula sed, maximus orci. Suspendisse in tincidunt lorem. Duis sit amet sapien tristique, dictum urna eu, sodales lorem. Suspendisse interdum neque ac lectus sollicitudin, bibendum ullamcorper orci feugiat. Nunc suscipit ipsum ac maximus fermentum. Duis fermentum mi in enim condimentum, a consequat metus fermentum. Donec risus orci, lacinia eu aliquet non, tincidunt in lectus. Aliquam ac elit metus. Quisque bibendum nibh tempor, venenatis dui quis, fringilla diam. Etiam quis odio nec dui convallis consequat. Mauris magna ante, luctus et eros sit amet, placerat sodales orci.","title":"Acerca de"},{"location":"about/#sobre-mi","text":"","title":"Sobre mi"},{"location":"about/#prueba","text":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris luctus tempus mi, nec sollicitudin quam fermentum at. Quisque sit amet sapien ac dolor pellentesque porta in a velit. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Mauris in purus non risus blandit sagittis. Interdum et malesuada fames ac ante ipsum primis in faucibus. Donec blandit, dolor eu vulputate viverra, ex eros lobortis enim, nec ullamcorper leo purus rhoncus sem. Praesent varius dui quis augue semper, sit amet interdum velit ultricies. Suspendisse vel accumsan orci. Aliquam sit amet aliquet neque. Etiam sed nibh ipsum. Aliquam id sapien ut dolor lacinia fermentum. Etiam luctus interdum tortor, ut bibendum sem pretium quis. Nulla aliquet consequat tristique. Nulla ut malesuada ipsum. Pellentesque id commodo augue, ut pharetra ante. Cras ante orci, lacinia vitae rhoncus tincidunt, porttitor non magna. Vivamus eu tempor velit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi aliquet ex sit amet felis laoreet, sed tincidunt lacus placerat. Phasellus et odio massa. Quisque pulvinar convallis molestie. Vivamus feugiat ut augue quis congue. Maecenas rutrum lorem a lorem aliquet, eget condimentum dui efficitur. Aliquam erat volutpat. Cras rhoncus eleifend nibh ac tincidunt. Integer vestibulum suscipit lectus, vel venenatis ipsum. Nullam a porttitor ante. Mauris et quam eu magna consectetur maximus. Morbi aliquet convallis dignissim. Etiam eleifend venenatis nunc et tristique. Pellentesque dolor mauris, euismod non vehicula vel, elementum quis dolor. Donec condimentum porttitor arcu, ut fringilla dui consequat egestas. Nulla ultricies efficitur sapien ut finibus. Integer eu mauris augue. Nunc congue molestie arcu eu ultrices. Pellentesque nulla risus, finibus eu cursus at, molestie a sem. Nullam accumsan scelerisque turpis nec semper. Nulla tincidunt convallis dignissim. Vestibulum metus ex, consequat ac rhoncus elementum, tempor a eros. In malesuada tincidunt nibh sed egestas. Aliquam sodales felis non mi suscipit bibendum. Phasellus et augue eget ipsum iaculis lacinia in et nunc. Nullam lorem justo, fringilla eu dictum nec, varius eget nibh. Praesent at suscipit est. Vestibulum et tellus condimentum, cursus ligula quis, semper felis. Pellentesque eu odio eget massa cursus placerat ornare et leo. Aenean non arcu ultrices, semper enim feugiat, commodo neque. Integer nec nisi placerat, tincidunt ligula sed, maximus orci. Suspendisse in tincidunt lorem. Duis sit amet sapien tristique, dictum urna eu, sodales lorem. Suspendisse interdum neque ac lectus sollicitudin, bibendum ullamcorper orci feugiat. Nunc suscipit ipsum ac maximus fermentum. Duis fermentum mi in enim condimentum, a consequat metus fermentum. Donec risus orci, lacinia eu aliquet non, tincidunt in lectus. Aliquam ac elit metus. Quisque bibendum nibh tempor, venenatis dui quis, fringilla diam. Etiam quis odio nec dui convallis consequat. Mauris magna ante, luctus et eros sit amet, placerat sodales orci.","title":"Prueba"},{"location":"docker-https/","text":"Pr\u00e1ctica HTTPS con Let's Encrypt y Certbot Pasos a realizar Paso 1 Crear instancia EC2 en AWS con los siguientes puertos: - SSH (22/TCP) - HTTP (80/TCP) - HTTPS (443/TCP) - Paso 2 Obtener la direcci\u00f3n IP de la instancia EC2 en AWS. Paso 3 Realizar la instalaci\u00f3n y configuraci\u00f3n de un sitio web . Utilizamos los scripts que tenemos de las pr\u00e1cticas anteriores. Paso 4 Registrar un nombre de dominio en alg\u00fan proveedor de dominio gratuito. En mi caso en NO-IP. Configuramos los registros DNS del proveedor de nombres de dominio para que el nombre del dominio que se ha registrado pueda resolver hacia la direcci\u00f3n p\u00fablica de la instancia en AWS. Como tenemos en el ejemplo de arriba. Paso 5 Realizamos la instalaci\u00f3n y la configuraci\u00f3n de Docker y Docker-compose en la instancia de AWS. En el script creado para esta pr\u00e1ctica podemos apreciar los siguientes pasos: #!/bin/bash # Actualizamos lista de repositorios apt update # Actualizamos los paquetes apt upgrade -y # Instalamos docker apt install docker -y # Instalamos docker-compose apt install docker-compose -y Paso 6 Modificar el archivo de docker-compose.yml de alguna de las pr\u00e1cticas anteriores para incluir el servicio de HTTPS-PORTAL version: '3.4' services: https-portal: image: steveltn/https-portal:1 ports: - 80:80 - 443:443 restart: always environment: DOMAINS: 'resti-docker.ddns.net -> http://prestashop:80' STAGE: 'production' networks: - frontend-network Pasos para no redirigir Nos metemos a phpmyadmin Vamos a SQL e introducimos: UPDATE ps_configuration SET value = '1' WHERE name = 'PS_SSL_ENABLED'; UPDATE ps_configuration SET value = '1' WHERE name = 'PS_SSL_ENABLED_EVERYWHERE'; C\u00f3digo docker-compose version: '3.4' services: https-portal: image: steveltn/https-portal:1 ports: - 80:80 - 443:443 restart: always environment: DOMAINS: 'resti-docker.ddns.net -> http://prestashop:80' STAGE: 'production' networks: - frontend-network phpmyadmin: image: phpmyadmin environment: - PMA_ARBITRARY=1 ports: - 8080:80 networks: - frontend-network - backend-network depends_on: - mysql restart: always mysql: image: mysql:5.7 ports: - 3306:3306 environment: - MYSQL_ROOT_PASSWORD=${MYSQL_ROOT_PASSWORD} - MYSQL_DATABASE=${MYSQL_DATABASE} - MYSQL_USER=${MYSQL_USER} - MYSQL_PASSWORD=${MYSQL_PASSWORD} volumes: - mysql_data:/var/lib/mysql networks: - backend-network restart: always prestashop: image: prestashop/prestashop environment: - DB_SERVER=${DB_SERVER} volumes: - prestashop_data:/var/www/html networks: - frontend-network - backend-network restart: always depends_on: - mysql networks: frontend-network: backend-network: volumes: mysql_data: prestashop_data:","title":"Practica-Docker-Https"},{"location":"docker-https/#practica-https-con-lets-encrypt-y-certbot","text":"","title":"Pr\u00e1ctica HTTPS con Let's Encrypt y Certbot"},{"location":"docker-https/#pasos-a-realizar","text":"","title":"Pasos a realizar"},{"location":"docker-https/#paso-1","text":"Crear instancia EC2 en AWS con los siguientes puertos: - SSH (22/TCP) - HTTP (80/TCP) - HTTPS (443/TCP) -","title":"Paso 1"},{"location":"docker-https/#paso-2","text":"Obtener la direcci\u00f3n IP de la instancia EC2 en AWS.","title":"Paso 2"},{"location":"docker-https/#paso-3","text":"Realizar la instalaci\u00f3n y configuraci\u00f3n de un sitio web . Utilizamos los scripts que tenemos de las pr\u00e1cticas anteriores.","title":"Paso 3"},{"location":"docker-https/#paso-4","text":"Registrar un nombre de dominio en alg\u00fan proveedor de dominio gratuito. En mi caso en NO-IP. Configuramos los registros DNS del proveedor de nombres de dominio para que el nombre del dominio que se ha registrado pueda resolver hacia la direcci\u00f3n p\u00fablica de la instancia en AWS. Como tenemos en el ejemplo de arriba.","title":"Paso 4"},{"location":"docker-https/#paso-5","text":"Realizamos la instalaci\u00f3n y la configuraci\u00f3n de Docker y Docker-compose en la instancia de AWS. En el script creado para esta pr\u00e1ctica podemos apreciar los siguientes pasos: #!/bin/bash # Actualizamos lista de repositorios apt update # Actualizamos los paquetes apt upgrade -y # Instalamos docker apt install docker -y # Instalamos docker-compose apt install docker-compose -y","title":"Paso 5"},{"location":"docker-https/#paso-6","text":"Modificar el archivo de docker-compose.yml de alguna de las pr\u00e1cticas anteriores para incluir el servicio de HTTPS-PORTAL version: '3.4' services: https-portal: image: steveltn/https-portal:1 ports: - 80:80 - 443:443 restart: always environment: DOMAINS: 'resti-docker.ddns.net -> http://prestashop:80' STAGE: 'production' networks: - frontend-network","title":"Paso 6"},{"location":"docker-https/#pasos-para-no-redirigir","text":"Nos metemos a phpmyadmin Vamos a SQL e introducimos: UPDATE ps_configuration SET value = '1' WHERE name = 'PS_SSL_ENABLED'; UPDATE ps_configuration SET value = '1' WHERE name = 'PS_SSL_ENABLED_EVERYWHERE';","title":"Pasos para no redirigir"},{"location":"docker-https/#codigo-docker-compose","text":"version: '3.4' services: https-portal: image: steveltn/https-portal:1 ports: - 80:80 - 443:443 restart: always environment: DOMAINS: 'resti-docker.ddns.net -> http://prestashop:80' STAGE: 'production' networks: - frontend-network phpmyadmin: image: phpmyadmin environment: - PMA_ARBITRARY=1 ports: - 8080:80 networks: - frontend-network - backend-network depends_on: - mysql restart: always mysql: image: mysql:5.7 ports: - 3306:3306 environment: - MYSQL_ROOT_PASSWORD=${MYSQL_ROOT_PASSWORD} - MYSQL_DATABASE=${MYSQL_DATABASE} - MYSQL_USER=${MYSQL_USER} - MYSQL_PASSWORD=${MYSQL_PASSWORD} volumes: - mysql_data:/var/lib/mysql networks: - backend-network restart: always prestashop: image: prestashop/prestashop environment: - DB_SERVER=${DB_SERVER} volumes: - prestashop_data:/var/www/html networks: - frontend-network - backend-network restart: always depends_on: - mysql networks: frontend-network: backend-network: volumes: mysql_data: prestashop_data:","title":"C\u00f3digo docker-compose"}]}